!function(t,i){"function"==typeof define&&define.amd?define(["jquery"],i):i(t.jQuery)}(this,function(d){var h,c,p,f,g,u,m,a,v,w,y;if(c=!!document.createElement("canvas").getContext,h=function(){var t=document.createElement("div");t.innerHTML='<v:shape id="vml_flag1" adj="1" />';var i=t.firstChild;return i.style.behavior="url(#default#VML)",!i||"object"==typeof i.adj}(),c||h){if(c){a=function(t){return Math.max(0,Math.min(parseInt(t,16),255))},v=function(t,i){return"rgba("+a(t.substr(0,2))+","+a(t.substr(2,2))+","+a(t.substr(4,2))+","+i+")"},p=function(t){var i=d('<canvas style="width:'+d(t).width()+"px;height:"+d(t).height()+'px;"></canvas>').get(0);return i.getContext("2d").clearRect(0,0,d(t).width(),d(t).height()),i};function C(t,a,e,o,r){if(o=o||0,r=r||0,t.beginPath(),"rect"==a)t.rect(e[0]+o,e[1]+r,e[2]-e[0],e[3]-e[1]);else if("poly"==a)for(t.moveTo(e[0]+o,e[1]+r),i=2;i<e.length;i+=2)t.lineTo(e[i]+o,e[i+1]+r);else"circ"==a&&t.arc(e[0]+o,e[1]+r,e[2],0,2*Math.PI,!1);t.closePath()}f=function(t,i,a,e,o){var r=t.getContext("2d");if(e.shadow){r.save(),"inside"==e.shadowPosition&&(C(r,i,a),r.clip());var n=100*t.width,s=100*t.height;C(r,i,a,n,s),r.shadowOffsetX=e.shadowX-n,r.shadowOffsetY=e.shadowY-s,r.shadowBlur=e.shadowRadius,r.shadowColor=v(e.shadowColor,e.shadowOpacity);var l=e.shadowFrom;"stroke"==(l=l||("outside"==e.shadowPosition?"fill":"stroke"))?(r.strokeStyle="rgba(0,0,0,1)",r.stroke()):"fill"==l&&(r.fillStyle="rgba(0,0,0,1)",r.fill()),r.restore(),"outside"==e.shadowPosition&&(r.save(),C(r,i,a),r.globalCompositeOperation="destination-out",r.fillStyle="rgba(0,0,0,1);",r.fill(),r.restore())}r.save(),C(r,i,a),e.fill&&(r.fillStyle=v(e.fillColor,e.fillOpacity),r.fill()),e.stroke&&(r.strokeStyle=v(e.strokeColor,e.strokeOpacity),r.lineWidth=e.strokeWidth,r.stroke()),r.restore(),e.fade&&d(t).css("opacity",0).animate({opacity:1},100)},g=function(t){t.getContext("2d").clearRect(0,0,t.width,t.height)}}else p=function(t){return d('<var style="zoom:1;overflow:hidden;display:block;width:'+t.width+"px;height:"+t.height+'px;"></var>').get(0)},f=function(t,i,a,e,o){var r,n,s,l;for(var h in a)a[h]=parseInt(a[h],10);r='<v:fill color="#'+e.fillColor+'" opacity="'+(e.fill?e.fillOpacity:0)+'" />',n=e.stroke?'strokeweight="'+e.strokeWidth+'" stroked="t" strokecolor="#'+e.strokeColor+'"':'stroked="f"',s='<v:stroke opacity="'+e.strokeOpacity+'"/>',"rect"==i?l=d('<v:rect name="'+o+'" filled="t" '+n+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+a[0]+"px;top:"+a[1]+"px;width:"+(a[2]-a[0])+"px;height:"+(a[3]-a[1])+'px;"></v:rect>'):"poly"==i?l=d('<v:shape name="'+o+'" filled="t" '+n+' coordorigin="0,0" coordsize="'+t.width+","+t.height+'" path="m '+a[0]+","+a[1]+" l "+a.join(",")+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+t.width+"px;height:"+t.height+'px;"></v:shape>'):"circ"==i&&(l=d('<v:oval name="'+o+'" filled="t" '+n+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+(a[0]-a[2])+"px;top:"+(a[1]-a[2])+"px;width:"+2*a[2]+"px;height:"+2*a[2]+'px;"></v:oval>')),l.get(0).innerHTML=r+s,d(t).append(l)},g=function(t){var i=d("<div>"+t.innerHTML+"</div>");i.children("[name=highlighted]").remove(),t.innerHTML=i.html()};u=function(t){var i,a=t.getAttribute("coords").split(",");for(i=0;i<a.length;i++)a[i]=parseFloat(a[i]);return[t.getAttribute("shape").toLowerCase().substr(0,4),a]},y=function(t,i){var a=d(t);return d.extend({},i,!!d.metadata&&a.metadata(),a.data("maphilight"))},w=function(t){return!!t.complete&&(void 0===t.naturalWidth||0!==t.naturalWidth)};var t=!(m={position:"absolute",left:0,top:0,padding:0,border:0});d.fn.maphilight=function(r){return r=d.extend({},d.fn.maphilight.defaults,r),c||t||(d(window).ready(function(){document.namespaces.add("v","urn:schemas-microsoft-com:vml");var t=document.createStyleSheet();d.each(["shape","rect","oval","circ","fill","stroke","imagedata","group","textbox"],function(){t.addRule("v\\:"+this,"behavior: url(#default#VML); antialias:true")})}),t=!0),this.each(function(){var a,t,n,s,l,e,i;if(a=d(this),!w(this))return window.setTimeout(function(){a.maphilight(r)},200);if(n=d.extend({},r,!!d.metadata&&a.metadata(),a.data("maphilight")),(i=a.get(0).getAttribute("usemap"))&&(s=d('map[name="'+i.substr(1)+'"]'),a.is('img,input[type="image"]')&&i&&0<s.length)){if(a.hasClass("maphilighted")){var o=a.parent();a.insertBefore(o),o.remove(),d(s).off(".maphilight")}t=d("<div></div>").css({display:"block",backgroundImage:'url("'+this.src+'")',backgroundSize:"contain",backgroundRepeat:"no-repeat",position:"relative",padding:0,width:this.width,height:this.height}),n.wrapClass&&(!0===n.wrapClass?t.addClass(d(this).attr("class")):t.addClass(n.wrapClass)),a.before(t).css("opacity",0).css(m).remove(),h&&a.css("filter","Alpha(opacity=0)"),t.append(a),l=p(this),d(l).css(m),l.height=this.height,l.width=this.width,d(s).on("alwaysOn.maphilight",function(){e&&g(e),c||d(l).empty(),d(s).find("area[coords]").each(function(){var t,i;(i=y(this,n)).shadow=!1,i.alwaysOn&&(!e&&c&&(e=p(a[0]),d(e).css(m),e.width=a[0].width,e.height=a[0].height,a.before(e)),i.fade=i.alwaysOnFade,t=u(this),f(c?e:l,t[0],t[1],i,""))})}).trigger("alwaysOn.maphilight").on("mouseover.maphilight, focus.maphilight",function(t){var i,a,e=t.target;if((a=y(e,n)).stroke=!1,a.false=!1,!a.neverOn){if(i=u(e),f(l,i[0],i[1],a,"highlighted"),a.groupBy){var o;o=/^[a-zA-Z][\-a-zA-Z]+$/.test(a.groupBy)?s.find("area["+a.groupBy+'="'+d(e).attr(a.groupBy)+'"]'):s.find(a.groupBy);var r=e;o.each(function(){if(this!=r){var t=y(this,n);if(!t.neverOn&&!t.alwaysOn){var i=u(this);f(l,i[0],i[1],t,"highlighted")}}})}c||d(l).append("<v:rect></v:rect>")}}).bind("mouseout.maphilight, blur.maphilight",function(t){g(l)}),a.before(l),a.addClass("maphilighted"),d(window).resize(function(){d(s).trigger("alwaysOn.maphilight")}).trigger("resize")}})},d.fn.maphilight.defaults={fill:!0,fillColor:"000000",fillOpacity:.2,stroke:!0,strokeColor:"ff0000",strokeOpacity:1,strokeWidth:1,fade:!0,alwaysOn:!1,neverOn:!1,groupBy:!1,wrapClass:!0,shadow:!1,shadowX:0,shadowY:0,shadowRadius:6,shadowColor:"000000",shadowOpacity:.8,shadowPosition:"outside",shadowFrom:!1}}else d.fn.maphilight=function(){return this}}),angular.module("ngMapHilight",[]).directive("angularMaphilight",function(n){return{restrict:"E",scope:{angularMaphilightConfig:"="},link:function(i,t,a){var e=t.find("img");$(e).attr("usemap","#"+a.id+".map");var o=t.find("map");function r(){if(i.angularMaphilightConfig){var t=angular.copy(i.angularMaphilightConfig);t.strokeColor&&"#"==t.strokeColor[0]&&(t.strokeColor=t.strokeColor.substr(1)),t.fillColor&&"#"==t.fillColor[0]&&(t.fillColor=t.fillColor.substr(1)),t.shadowColor&&"#"==t.shadowColor[0]&&(t.shadowColor=t.shadowColor.substr(1))}$(e).on("load",function(){$(e).maphilight(t)}).trigger("load")}$(o).attr("id",a.id+".map"),$(o).attr("name",a.id+".map"),e.on("load",function(){var s=$(e).attr("width"),l=$(e).attr("height");angular.element=window.jQuery,angular.element(n).resize(function(){if(!s||!l){var t=new Image;t.src=$(e).attr("src"),null==t.src&&(t.src=$(e).attr("ng-src")),s=s||t.width,l=l||t.height}var o=$(e).width()/100,r=$(e).height()/100,i=$(e).attr("usemap").replace("#",""),n="coords";angular.element('map[name="'+i+'"]').find("area").each(function(){var t=$(this);t.data(n)||t.data(n,t.attr(n));for(var i=t.data(n).split(","),a=new Array(i.length),e=0;e<a.length;++e)a[e]=e%2==0?parseInt(i[e]/s*100*o):parseInt(i[e]/l*100*r);t.attr(n,a.toString())})}).trigger("resize")}),i.$watch("angularMaphilightConfig",r,!0),i.redrawCanvas=function(){r()}},controller:function(t){this.redrawCanvas=function(){t.redrawCanvas()}}}}).directive("maphilightCustomStyle",function(){return{restrict:"A",require:"^angularMaphilight",scope:{maphilightCustomStyle:"="},link:function(t,i,a,e){t.$watch("maphilightCustomStyle",function(){$(i).data("maphilight",t.maphilightCustomStyle),e.redrawCanvas()},!0)}}});